# My Gists (responders branch)

The *_responders_* branch contains an example usage – adding remarks to gists.

Kod jest na gałęzi _responders_:

```sh
git checkout responders
git push --set-upstream origin responders # pushing local branch to GitHub
```

Tutorial:

. http://edgeguides.rubyonrails.org/getting_started.html#adding-a-second-model[Adding a Second Model]


Cloning repo on a new computer:
```sh
git pull git@github.com:rails4/my_gists_5.0.git
cd my_gists_5.0
git checkout --track origin/responders
```


## Responders

Docs:

* https://github.com/plataformatec/responders[gem responders]
* also includes a responders controller generator, so your scaffold
  can be customized to use respond_with instead of default respond_to blocks.
+
you need to explicitly opt-in to use this generator by adding the following
to your _config/environments/development.rb_:
```ruby
config.app_generators.scaffold_controller :responders_controller
```

Konfigurujemy generator tak jak to opisano powyżej,
dopisujemy gem _reponders_ do _Gemfile_. Następnie wykonujemy

```sh
bundle install
rails generate responders:install
      create  lib/application_responder.rb
      insert  config/application.rb
     prepend  app/controllers/application_controller.rb
      insert  app/controllers/application_controller.rb
      create  config/locales/responders.en.yml
```

### Scaffolding Remark controller

Stubs out a scaffolded controller and its views. Different from rails
scaffold_controller, it uses respond_with instead of respond_to blocks. Pass the
model name, either CamelCased or under_scored. The controller name is retrieved
as a pluralized version of the model name.

```ruby
rails g responders_controller Remark note:text
      create  app/controllers/remarks_controller.rb
      invoke  erb
      create    app/views/remarks
      create    app/views/remarks/index.html.erb
      create    app/views/remarks/edit.html.erb
      create    app/views/remarks/show.html.erb
      create    app/views/remarks/new.html.erb
      create    app/views/remarks/_form.html.erb
```

Wygenerowany _RemarkController_ – obsługuje tylko jeden format – HTML.
I o to chodziło! Przy okazji kod kontrolera jest krótszy i bardziej zrozumiały.

```ruby
class RemarksController < ApplicationController
  before_action :set_remark, only: [:show, :edit, :update, :destroy]

  respond_to :html

  def index
    @remarks = Remark.all
    respond_with(@remarks)
  end

  def show
    respond_with(@remark)
  end

  def new
    @remark = Remark.new
    respond_with(@remark)
  end

  def edit
  end

  def create
    @remark = Remark.new(remark_params)
    @remark.save
    respond_with(@remark)
  end

  def update
    @remark.update(remark_params)
    respond_with(@remark)
  end

  def destroy
    @remark.destroy
    respond_with(@remark)
  end

  private
    def set_remark
      @remark = Remark.find(params[:id])
    end

    def remark_params
      params.require(:remark).permit(:note)
    end
end
```

### Next steps

Teraz piszemy kod tak jak to robiliśmy dodając komentarze do gist-ów.
